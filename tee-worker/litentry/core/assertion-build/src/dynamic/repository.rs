// Copyright 2020-2024 Trust Computing GmbH.
// This file is part of Litentry.
//
// Litentry is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Litentry is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with Litentry.  If not, see <https://www.gnu.org/licenses/>.

#[cfg(all(feature = "std", feature = "sgx"))]
compile_error!("feature \"std\" and feature \"sgx\" cannot be enabled at the same time");

#[cfg(all(not(feature = "std"), feature = "sgx"))]
extern crate sgx_tstd as std;

use lc_dynamic_assertion::AssertionLogicRepository;
use primitive_types::H160;
use std::{
	collections::HashMap,
	string::{String, ToString},
	sync::Mutex,
	vec,
	vec::Vec,
};

pub type SmartContractByteCode = Vec<u8>;
#[allow(clippy::type_complexity)]
pub struct InMemorySmartContractRepo {
	map: Mutex<HashMap<H160, (Vec<u8>, Vec<String>)>>,
}

impl InMemorySmartContractRepo {
	pub fn new() -> Self {
		let mut map = HashMap::new();
		//a1
		map.insert(
            hash(0),
			(
				hex::decode("608060405234801561001057600080fd5b50610af2806100206000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c8063e256184614610030575b600080fd5b61004361003e366004610661565b61005d565b60405161005495949392919061085f565b60405180910390f35b60608060608060008060405180608001604052806045815260200161098460459139604080518082018252601b81527f4261736963204964656e7469747920566572696669636174696f6e000000000060208083019190915260008054600181018255818052845160c08101909552608180865295965092947f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e56390930193909290916109c990830139805161011993925060209091019061041e565b506040518060a0016040528060738152602001610a4a6073913980516101479160019160209091019061041e565b5060008080805b8c518110156101c5576101798d828151811061016c5761016c610909565b6020026020010151610351565b1561018757600191506101b3565b6101a98d828151811061019c5761019c610909565b6020026020010151610380565b156101b357600192505b806101bd8161091f565b91505061014e565b508080156101d05750815b92508484600060018682805480602002602001604051908101604052809291908181526020016000905b828210156102a657838290600052602060002001805461021990610948565b80601f016020809104026020016040519081016040528092919081815260200182805461024590610948565b80156102925780601f1061026757610100808354040283529160200191610292565b820191906000526020600020905b81548152906001019060200180831161027557829003601f168201915b5050505050815260200190600101906101fa565b5050505092508180546102b890610948565b80601f01602080910402602001604051908101604052809291908181526020018280546102e490610948565b80156103315780601f1061030657610100808354040283529160200191610331565b820191906000526020600020905b81548152906001019060200180831161031457829003601f168201915b505050505091509950995099509950995050505050509295509295909350565b600061035c826103a9565b8061036b575061036b826103b6565b8061037a575061037a826103c3565b92915050565b600061038b826103d0565b8061039a575061039a826103dd565b8061037a575061037a826103ea565b600061037a8260006103f3565b600061037a8260016103f3565b600061037a8260026103f3565b600061037a8260036103f3565b600061037a8260046103f3565b600061037a8260055b60008163ffffffff16836000015163ffffffff1614156104155750600161037a565b50600092915050565b82805461042a90610948565b90600052602060002090601f01602090048101928261044c5760008555610492565b82601f1061046557805160ff1916838001178555610492565b82800160010185558215610492579182015b82811115610492578251825591602001919060010190610477565b5061049e9291506104a2565b5090565b5b8082111561049e57600081556001016104a3565b634e487b7160e01b600052604160045260246000fd5b6040516060810167ffffffffffffffff811182821017156104f0576104f06104b7565b60405290565b604051601f8201601f1916810167ffffffffffffffff8111828210171561051f5761051f6104b7565b604052919050565b600067ffffffffffffffff821115610541576105416104b7565b5060051b60200190565b803563ffffffff8116811461055f57600080fd5b919050565b600067ffffffffffffffff83111561057e5761057e6104b7565b610591601f8401601f19166020016104f6565b90508281528383830111156105a557600080fd5b828260208301376000602084830101529392505050565b600082601f8301126105cd57600080fd5b813560206105e26105dd83610527565b6104f6565b82815260059290921b8401810191818101908684111561060157600080fd5b8286015b8481101561065657803567ffffffffffffffff8111156106255760008081fd5b8701603f810189136106375760008081fd5b610648898683013560408401610564565b845250918301918301610605565b509695505050505050565b6000806040838503121561067457600080fd5b823567ffffffffffffffff8082111561068c57600080fd5b818501915085601f8301126106a057600080fd5b813560206106b06105dd83610527565b82815260059290921b840181019181810190898411156106cf57600080fd5b8286015b848110156107e2578035868111156106ea57600080fd5b87016060818d03601f1901121561070057600080fd5b6107086104cd565b61071386830161054b565b815260408201358881111561072757600080fd5b8201603f81018e1361073857600080fd5b6107498e8883013560408401610564565b878301525060608201358881111561076057600080fd5b8083019250508c603f83011261077557600080fd5b858201356107856105dd82610527565b81815260059190911b83018701870190878101908f8311156107a657600080fd5b6040850194505b828510156107cd576107be8561054b565b825293880193908801906107ad565b604084015250508452509183019183016106d3565b50965050860135925050808211156107f957600080fd5b50610806858286016105bc565b9150509250929050565b60008151808452602060005b8281101561083757848101820151868201830152810161081c565b828111156108485760008284880101525b5080601f19601f8401168601019250505092915050565b60a08152600061087260a0830188610810565b6020838203818501526108858289610810565b915083820360408501528187518084528284019150828160051b850101838a0160005b838110156108d657601f198784030185526108c4838351610810565b948601949250908501906001016108a8565b505086810360608801526108ea818a610810565b955050505050506108ff608083018415159052565b9695505050505050565b634e487b7160e01b600052603260045260246000fd5b600060001982141561094157634e487b7160e01b600052601160045260246000fd5b5060010190565b600181811c9082168061095c57607f821691505b6020821081141561097d57634e487b7160e01b600052602260045260246000fd5b5091905056fe596f75277665206964656e746966696564206174206c65617374206f6e65206163636f756e742f6164647265737320696e20626f7468205765623220616e6420576562332e7b22616e64223a205b7b2022737263223a2022246861735f776562325f6163636f756e74222c20226f70223a20223d3d222c2022647374223a20227472756522207d2c207b2022737263223a2022246861735f776562335f6163636f756e74222c20226f70223a20223d3d222c2022647374223a20227472756522207d205d207d68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6c6974656e7472792f76632d6a736f6e736368656d612f6d61696e2f646973742f736368656d61732f312d62617369632d6964656e746974792d766572696669636174696f6e2f312d302d302e6a736f6ea264697066735822122008b51c7962c3c5639c7c2aac2c98e97f666aa49e961a5e962f030f4ac4a9a47d64736f6c634300080b0033").unwrap(),
				vec![]
				)
        );
		//a20
		map.insert(
			hash(1),
			(
				hex::decode("608060405234801561001057600080fd5b50610d8b806100206000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c8063e256184614610030575b600080fd5b61004361003e3660046107c1565b61005d565b6040516100549594939291906109cb565b60405180910390f35b6060806060806000806040518060c0016040528060868152602001610c5960869139604080518082018252601c81527f49444875622045564d2056657273696f6e204561726c7920426972640000000060208083019190915260008054600181018255818052845160608101909552603380865295965092947f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e5639093019390929091610cdf90830139805161011993925060209091019061057e565b506040518060a0016040528060758152602001610be46075913980516101479160019160209091019061057e565b506000805b8a51811015610289576101778b828151811061016a5761016a610a75565b6020026020010151610407565b15610277576000806101a58d848151811061019457610194610a75565b602002602001015160200151610436565b91509150811561026757816101bb575050610277565b60006101df604051806080016040528060448152602001610d126044913983610498565b604080518082018252600a8152690bda185cd29bda5b995960b21b60208083019190915282516000808252918101909352929350919081610242565b604080518082019091526060808252602082015281526020019060019003908161021b5790505b5090506000806102538585856104c7565b915091508115610261578098505b50505050505b8315610274575050610289565b50505b8061028181610a8b565b91505061014c565b508282600060018482805480602002602001604051908101604052809291908181526020016000905b8282101561035e5783829060005260206000200180546102d190610ab4565b80601f01602080910402602001604051908101604052809291908181526020018280546102fd90610ab4565b801561034a5780601f1061031f5761010080835404028352916020019161034a565b820191906000526020600020905b81548152906001019060200180831161032d57829003601f168201915b5050505050815260200190600101906102b2565b50505050925081805461037090610ab4565b80601f016020809104026020016040519081016040528092919081815260200182805461039c90610ab4565b80156103e95780601f106103be576101008083540402835291602001916103e9565b820191906000526020600020905b8154815290600101906020018083116103cc57829003601f168201915b50505050509150975097509750975097505050509295509295909350565b600061041282610531565b8061042157506104218261053e565b8061043057506104308261054b565b92915050565b6000606060008360405160200161044d9190610aef565b60408051601f1981840301815290829052805190925090611000818360208601600061041b600019f161047f57600080fd5b8094506040810193506110008101604052505050915091565b6060600083836040516020016104af929190610b09565b60408051808303601f19018152919052949350505050565b60008060008060008787876040516020016104e493929190610b38565b60408051601f198184030181528282528051909350919081836020860160006103e9600019f161051357600080fd5b8051602082015160409283019092529a909950975050505050505050565b6000610430826003610554565b6000610430826004610554565b60006104308260055b60008163ffffffff16836000015163ffffffff16141561057657506001610430565b506000610430565b82805461058a90610ab4565b90600052602060002090601f0160209004810192826105ac57600085556105f2565b82601f106105c557805160ff19168380011785556105f2565b828001600101855582156105f2579182015b828111156105f25782518255916020019190600101906105d7565b506105fe929150610602565b5090565b5b808211156105fe5760008155600101610603565b634e487b7160e01b600052604160045260246000fd5b6040516060810167ffffffffffffffff8111828210171561065057610650610617565b60405290565b604051601f8201601f1916810167ffffffffffffffff8111828210171561067f5761067f610617565b604052919050565b600067ffffffffffffffff8211156106a1576106a1610617565b5060051b60200190565b803563ffffffff811681146106bf57600080fd5b919050565b600067ffffffffffffffff8311156106de576106de610617565b6106f1601f8401601f1916602001610656565b905082815283838301111561070557600080fd5b828260208301376000602084830101529392505050565b600082601f83011261072d57600080fd5b8135602061074261073d83610687565b610656565b82815260059290921b8401810191818101908684111561076157600080fd5b8286015b848110156107b657803567ffffffffffffffff8111156107855760008081fd5b8701603f810189136107975760008081fd5b6107a88986830135604084016106c4565b845250918301918301610765565b509695505050505050565b600080604083850312156107d457600080fd5b823567ffffffffffffffff808211156107ec57600080fd5b818501915085601f83011261080057600080fd5b8135602061081061073d83610687565b82815260059290921b8401810191818101908984111561082f57600080fd5b8286015b848110156109415780358681111561084a57600080fd5b87016060818d03601f1901121561086057600080fd5b61086861062d565b6108738683016106ab565b815260408201358881111561088757600080fd5b8201603f81018e1361089857600080fd5b6108a98e88830135604084016106c4565b87830152506060820135888111156108c057600080fd5b8083019250508c603f8301126108d557600080fd5b858201356108e561073d82610687565b81815260059190911b830160400190878101908f83111561090557600080fd5b6040850194505b8285101561092c5761091d856106ab565b8252938801939088019061090c565b60408401525050845250918301918301610833565b509650508601359250508082111561095857600080fd5b506109658582860161071c565b9150509250929050565b60005b8381101561098a578181015183820152602001610972565b83811115610999576000848401525b50505050565b600081518084526109b781602086016020860161096f565b601f01601f19169290920160200192915050565b60a0815260006109de60a083018861099f565b6020838203818501526109f1828961099f565b915083820360408501528187518084528284019150828160051b850101838a0160005b83811015610a4257601f19878403018552610a3083835161099f565b94860194925090850190600101610a14565b50508681036060880152610a56818a61099f565b95505050505050610a6b608083018415159052565b9695505050505050565b634e487b7160e01b600052603260045260246000fd5b6000600019821415610aad57634e487b7160e01b600052601160045260246000fd5b5060010190565b600181811c90821680610ac857607f821691505b60208210811415610ae957634e487b7160e01b600052602260045260246000fd5b50919050565b602081526000610b02602083018461099f565b9392505050565b60008351610b1b81846020880161096f565b835190830190610b2f81836020880161096f565b01949350505050565b606081526000610b4b606083018661099f565b602083820381850152610b5e828761099f565b91506040848303818601528286518085528385019150838160051b86010184890160005b83811015610bd257878303601f1901855281518051878552610ba68886018261099f565b91890151858303868b0152919050610bbe818361099f565b968901969450505090860190600101610b82565b50909b9a505050505050505050505056fe68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6c6974656e7472792f76632d6a736f6e736368656d612f6d61696e2f646973742f736368656d61732f31322d69646875622d65766d2d76657273696f6e2d6561726c792d626972642f312d302d302e6a736f6e546865207573657220697320616e206561726c7920626972642075736572206f6620746865204964656e746974794875622045564d2076657273696f6e20616e64206861732067656e657261746564206174206c6561737420312063726564656e7469616c20647572696e672032303233204175672031347468207e2041756720323173742e7b2022737263223a2022246861735f6a6f696e6564222c20226f70223a20223d3d222c2022647374223a20227472756522207d687474703a2f2f6c6f63616c686f73743a31393532372f6576656e74732f646f65732d757365722d6a6f696e65642d65766d2d63616d706169676e3f6163636f756e743da26469706673582212204f649e301bd283e006c1969af8be484a752224ee88424af5f91820ad5acb4e4464736f6c634300080b0033").unwrap(),
				vec![]
				)
		);
		//a6
		map.insert(
			hash(2),
			(
				hex::decode("608060405234801561001057600080fd5b50611148806100206000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c8063e256184614610030575b600080fd5b61004361003e366004610b55565b61005d565b604051610054959493929190610d5f565b60405180910390f35b6060806060806000806040518060600160405280602e81526020016110e5602e9139905060006040518060400160405280601781526020017f5477697474657220466f6c6c6f77657220416d6f756e7400000000000000000081525090506040518060a00160405280606f8152602001610fdb606f913980516100e89160019160209091019061091b565b50600080805b8b51811015610220576101198c828151811061010c5761010c610e09565b6020026020010151610579565b1561020e57600061015f6040518060600160405280602b8152602001611081602b91398e848151811061014e5761014e610e09565b60200260200101516020015161058c565b905060006101a2826040518060400160405280601b81526020017f3f757365722e6669656c64733d7075626c69635f6d657472696373000000000081525061058c565b905060006101c98e6000815181106101bc576101bc610e09565b60200260200101516105bb565b90506000806101f184604051806060016040528060248152602001610fb7602491398561065e565b915091508115610208576102058188610e35565b96505b50505050505b8061021881610e86565b9150506100ee565b5060008060008360070b1215801561023c575060018360070b13155b1561024d5750600090506001610318565b60018360070b138015610264575060648360070b13155b156102755750600190506064610318565b60648360070b13801561028d57506103e88360070b13155b1561029f5750606490506103e8610318565b6103e88360070b1380156102b857506127108360070b13155b156102cb57506103e89050612710610318565b6127108360070b1380156102e55750620186a08360070b13155b156102f957506127109050620186a0610318565b620186a08360070b13156103185750620186a09050677fffffffffffffff5b8160070b60001415935060006103516040518060600160405280603981526020016110ac6039913961034c8560070b6106c8565b61058c565b90506103758160405180606001604052806037815260200161104a6037913961058c565b90506103878161034c8460070b6106c8565b90506103b2816040518060400160405280600781526020016622207d205d207d60c81b81525061058c565b6000805460018101825590805281519192506103f7917f290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e56390910190602084019061091b565b508686600060018882805480602002602001604051908101604052809291908181526020016000905b828210156104cc57838290600052602060002001805461043f90610ea1565b80601f016020809104026020016040519081016040528092919081815260200182805461046b90610ea1565b80156104b85780601f1061048d576101008083540402835291602001916104b8565b820191906000526020600020905b81548152906001019060200180831161049b57829003601f168201915b505050505081526020019060010190610420565b5050505092508180546104de90610ea1565b80601f016020809104026020016040519081016040528092919081815260200182805461050a90610ea1565b80156105575780601f1061052c57610100808354040283529160200191610557565b820191906000526020600020905b81548152906001019060200180831161053a57829003601f168201915b505050505091509b509b509b509b509b50505050505050509295509295909350565b600061058682600061073a565b92915050565b6060600083836040516020016105a3929190610edc565b60408051808303601f19018152919052949350505050565b60408051600180825281830190925260609160009190816020015b60408051808201909152606080825260208201528152602001906001900390816105d657505060408051608081018252600d9181019182526c30baba3437b934bd30ba34b7b760991b60608201529081529091506020810161063785610764565b8152508160008151811061064d5761064d610e09565b602090810291909101015292915050565b600080600080600087878760405160200161067b93929190610f0b565b60408051601f198184030181528282528051909350919081836020860160006103e8600019f16106aa57600080fd5b8051602082015160409283019092529a909950975050505050505050565b6060600082126106e75760405180602001604052806000815250610702565b604051806040016040528060018152602001602d60f81b8152505b61071361070e8461078f565b6107a6565b604051602001610724929190610edc565b6040516020818303038152906040529050919050565b60008163ffffffff16836000015163ffffffff16141561075c57506001610586565b506000610586565b60606105866040518060400160405280600781526020016602132b0b932b9160cd1b8152508361058c565b6000808212156107a25781600003610586565b5090565b606060006107b383610843565b600101905060008167ffffffffffffffff8111156107d3576107d36109ab565b6040519080825280601f01601f1916602001820160405280156107fd576020820181803683370190505b5090508181016020015b600019016f181899199a1a9b1b9c1cb0b131b232b360811b600a86061a8153600a85049450846108365761083b565b610807565b509392505050565b60008072184f03e93ff9f4daa797ed6e38ed64bf6a1f0160401b83106108825772184f03e93ff9f4daa797ed6e38ed64bf6a1f0160401b830492506040015b6d04ee2d6d415b85acef810000000083106108ae576d04ee2d6d415b85acef8100000000830492506020015b662386f26fc1000083106108cc57662386f26fc10000830492506010015b6305f5e10083106108e4576305f5e100830492506008015b61271083106108f857612710830492506004015b6064831061090a576064830492506002015b600a83106105865760010192915050565b82805461092790610ea1565b90600052602060002090601f016020900481019282610949576000855561098f565b82601f1061096257805160ff191683800117855561098f565b8280016001018555821561098f579182015b8281111561098f578251825591602001919060010190610974565b506107a29291505b808211156107a25760008155600101610997565b634e487b7160e01b600052604160045260246000fd5b6040516060810167ffffffffffffffff811182821017156109e4576109e46109ab565b60405290565b604051601f8201601f1916810167ffffffffffffffff81118282101715610a1357610a136109ab565b604052919050565b600067ffffffffffffffff821115610a3557610a356109ab565b5060051b60200190565b803563ffffffff81168114610a5357600080fd5b919050565b600067ffffffffffffffff831115610a7257610a726109ab565b610a85601f8401601f19166020016109ea565b9050828152838383011115610a9957600080fd5b828260208301376000602084830101529392505050565b600082601f830112610ac157600080fd5b81356020610ad6610ad183610a1b565b6109ea565b82815260059290921b84018101918181019086841115610af557600080fd5b8286015b84811015610b4a57803567ffffffffffffffff811115610b195760008081fd5b8701603f81018913610b2b5760008081fd5b610b3c898683013560408401610a58565b845250918301918301610af9565b509695505050505050565b60008060408385031215610b6857600080fd5b823567ffffffffffffffff80821115610b8057600080fd5b818501915085601f830112610b9457600080fd5b81356020610ba4610ad183610a1b565b82815260059290921b84018101918181019089841115610bc357600080fd5b8286015b84811015610cd557803586811115610bde57600080fd5b87016060818d03601f19011215610bf457600080fd5b610bfc6109c1565b610c07868301610a3f565b8152604082013588811115610c1b57600080fd5b8201603f81018e13610c2c57600080fd5b610c3d8e8883013560408401610a58565b8783015250606082013588811115610c5457600080fd5b8083019250508c603f830112610c6957600080fd5b85820135610c79610ad182610a1b565b81815260059190911b830160400190878101908f831115610c9957600080fd5b6040850194505b82851015610cc057610cb185610a3f565b82529388019390880190610ca0565b60408401525050845250918301918301610bc7565b5096505086013592505080821115610cec57600080fd5b50610cf985828601610ab0565b9150509250929050565b60005b83811015610d1e578181015183820152602001610d06565b83811115610d2d576000848401525b50505050565b60008151808452610d4b816020860160208601610d03565b601f01601f19169290920160200192915050565b60a081526000610d7260a0830188610d33565b602083820381850152610d858289610d33565b915083820360408501528187518084528284019150828160051b850101838a0160005b83811015610dd657601f19878403018552610dc4838351610d33565b94860194925090850190600101610da8565b50508681036060880152610dea818a610d33565b95505050505050610dff608083018415159052565b9695505050505050565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b60008160070b8360070b6000821282677fffffffffffffff03821381151615610e6057610e60610e1f565b82677fffffffffffffff19038212811615610e7d57610e7d610e1f565b50019392505050565b6000600019821415610e9a57610e9a610e1f565b5060010190565b600181811c90821680610eb557607f821691505b60208210811415610ed657634e487b7160e01b600052602260045260246000fd5b50919050565b60008351610eee818460208801610d03565b835190830190610f02818360208801610d03565b01949350505050565b606081526000610f1e6060830186610d33565b602083820381850152610f318287610d33565b91506040848303818601528286518085528385019150838160051b86010184890160005b83811015610fa557878303601f1901855281518051878552610f7988860182610d33565b91890151858303868b0152919050610f918183610d33565b968901969450505090860190600101610f55565b50909b9a505050505050505050505056fe2f646174612f7075626c69635f6d6574726963732f666f6c6c6f776572735f636f756e7468747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f6c6974656e7472792f76632d6a736f6e736368656d612f6d61696e2f646973742f736368656d61732f362d747769747465722d666f6c6c6f7765722d616d6f756e742f312d312d312e6a736f6e22207d2c207b2022737263223a2022246861735f776562335f6163636f756e74222c20226f70223a20223c3d222c2022647374223a2022687474703a2f2f6c6f63616c686f73743a31393532382f322f75736572732f62792f757365726e616d652f7b22616e64223a205b7b2022737263223a202224746f74616c5f666f6c6c6f77657273222c20226f70223a20223e222c2022647374223a20225468652072616e6765206f662074686520757365722773205477697474657220666f6c6c6f77657220636f756e74a264697066735822122043552c15b5a126b734447b17ad16ec5cb3b87a35973c7763e655f3e13e9a32db64736f6c634300080b0033").unwrap(),
				vec!["twitter_api_key".to_string()]
				)
		);
		InMemorySmartContractRepo { map: map.into() }
	}
}

impl Default for InMemorySmartContractRepo {
	fn default() -> Self {
		Self::new()
	}
}

impl AssertionLogicRepository for InMemorySmartContractRepo {
	type Id = H160;
	type Item = (Vec<u8>, Vec<String>);

	fn get(&self, id: &H160) -> Result<Option<Self::Item>, String> {
		Ok(self.map.lock().unwrap().get(id).cloned())
	}

	fn save(&self, id: Self::Id, item: Self::Item) -> Result<(), String> {
		self.map.lock().unwrap().insert(id, item);
		Ok(())
	}
}

fn hash(a: u64) -> H160 {
	H160::from_low_u64_be(a)
}
